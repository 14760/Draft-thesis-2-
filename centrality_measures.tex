\chapter{Centrality measures}




 \begin{displayquote}
 I asked a person of intelligence how many steps he thought it would take, and he said that it would require 100 intermediate persons, or more, to move from Nebraska to Sharon.
 
 Stanley Milgram 1969
\end{displayquote}




Networks can be subject to analysis at at least three levels: first the properties of the network as a whole such as the small world property, secondly the properties of individual vertices and their importance and significance within the network and finally the analysis of the presence of meso scale structures such as communities.\textcolor{red}{this is the bit where you tell people what you are going to do if it is not that then move it down to the next bit and tell people what you are going to do. }

This chapter examines measures of vertex importance for the post synaptic proteome network. It explores the significance of these statistics, their implication for the function of the network and association with specific functions and finally with molecular cognition first in model organisms and finally with differences in cognitive ability in population GWA studies.   ? ref ma and goa.

While the measures of vertex importance are precisely defined how they will map onto animal models or complex traits is not and one can construct several plausible hypotheses of effect, effect of specific measures or no effect (hence the quotation at the start of the chapter\todo{?move this down into a fuller introduction section}.

\section{Properties of empirical networks}
\label{sec:Properties of empirical networks}
In addition to community structure which we will examine in chapter~\ref{chap:community detection} empirical networks may contain features such as a power law distribution, large clustering component and giant connected component. These can provide information on how networks form and evolve. They are not all shared by all empirical networks. For example road networks do not show a scale free property although air travel networks do.\textcolor{red}{? remove this or move it into the bit above}\todo{? remove this section or merge with earlier}. We can test for the existence of these properties by determining how a network differs from either a completely random model or a model in which some of its features (such as degree distribution (section \ref{sec:degree distribution}.
\todo{?add global graph measures}

\section{Measures of vertex importance}
\label{sec:Measurs of vertex importance from paper}
\todo{Move this to importance}
To test the hypothesis that genes encoding proteins with an important role in the structure of the PSP network were more likely to be associated with genetic variants associated with differences in intelligence or educational attainment (such as hubs), we calculated node degree, and four other measures of vertex importance: eigenvector centrality, betweenness centrality, closeness centrality and transitivity for each graph vertex (gene) using igraph. \cite{csardi2006igraph} \textcolor{red}{we need to say what all of these are before we start talking about them}\footnote{something like we will first of all need to introduce in general terms these measures and how they were calculated. in general also want to move more of this chapter into methods and results}. There was no correlation between any of these measures of vertex importance and their gene association analysis gene level statistics calculated using MAGMA (Spearman’s $\rho$ calculated with R) for genes in the post synaptic proteome graph. The results are presented in table 1\todo{table}. The complete vertex statistics for each PSP gene can be found in the supplementary material. 

\subsubsection{Results of correlation analysis}
The vertex measures are correlated with one another apart from transitivity and range from 0.89 (eigenvector centrality and degree) to 0.33 (betweenness centrality and closeness centrality) (\textcolor{red}{see supplementary table 6} \todo{table}).
There is a weak negative ($\rho \approx 0.2$) correlation between the degree of selection pressure a gene is under and all measures of vertex importance except for transitivity (\textcolor{red}{see table 7 supplemental material} \todo{table}).
Although nodes of high importance or local clustering do have distinct properties, for example nodes with degree $> 50$ are enriched in association for the biological process (GO:1903350)‚ ”intracellular response to dopamine‚” (FDR P= 2.10 $\times 10^{-4}$ fold change 22.37), we find no correlation with these measures and genetic association with educational attainment or intelligence. 
\textcolor{green}{DRAFT -something like This is not because nodes of high degree or other centrality measure do not share common attributes, for example nodes with degree $>50$ are disproportionately found in BP intracellular dopamine but we find no association between these measures and educational attainment or intelligence}

\section{Centrality measures}
Centrality measures show how important as node is within the network and a variety of statistics use different measures of importance (see section~\ref{sec: intro_centrality_measures}). Many are correlated with each other although their correlation varies.\textcolor{red}{move this down}. We will consider degree, eigenvector centrality, betweenness, closeness and transitivity. All measures are derived from the adjacency.

Figure~\ref{fig:dolphin} shows vertex betweenness centrality, eigenvector centrality and local transitivity. High values of these measures are shown in red. The data is from a social network of bottle nose dolphins \footnote{\url{http://www-personal.umich.edu/~mejn/netdata/dolphins.zip}} \cite{lusseau2003bottlenose} \todo{Make vertices bigger in figure}.


\begin{figure}
    \centering
    \includegraphics[width=0.9\textwidth]{images/centrality2.002.png}
    \caption{Display of centrality measures. Betweenness centrality, eigenvector centrality and local transitivity for network of bottle nose dolphin social relations data. \cite{lusseau2003bottlenose}}
    \label{fig:dolphin}
\end{figure}

\section{Why be interested in centrality measures}
\textcolor{red}{Start move}
An example of a property of an individual node is its degree: the number of connections (edges) it has to other nodes. High degree nodes are called hubs and proteome hub proteins are known to be more commonly essential to life and expressed ubiquitously. \cite{goh2007human}  Unregulated\todo{check unregulated or upregulated} genes in cancer proteomic networks have been found to be of high degree. \cite{wachi2005interactome}  High degree nodes were  involved in more diseases in the Online Mendelian Inheritance in Man (OMIM) compendium of genetic phenotypes. \cite{xu2006discovering}  Goh however found that disease genes were likely to be tissue specific and were not more likely to be hubs. \cite{goh2007human}  

Other vertex measures include eigenvector centrality, a measure of the importance of the node that includes the degree of its neighbours. \cite{bonacich1987power}  Some nodes are bottlenecks in the network. If a large number of the shortest (geodesic) paths pass through a node it is a potential bottleneck and its removal can disrupt the integrity of the network. The measure of a nodes propensity to be a bottleneck is the betweenness centrality. \cite{freeman1977set}  
\textcolor{red}{Stop move}

\cite{lee2013network} examined NHGRI complex trait catalog and found that complex trait loci were more likely to be hubs or bottlenecks (although this is 2013). Defining hub and bottleneck as top 20\% of distribution. 
\cite{liu2017sigmod} described a method of identifying gene modules and combining this with p values but use heterogenous different measures of gene interaction including coexpression. 
\cite{bayes2011characterization} found strong sequence conservation in PSP hub proteins. So there is some evidence that we might suspect they have an influence on human cognition using the G2C framework but as this is complex what we need is empirical proof indeed one can make a plausible argument from the available evidence for the effect of a specific measure, for an effect of centrality generally or for no effect \todo{? add box}.  

\todo{Add introduction}
\section{Summary of centrality measures}

The summary values for the centrality measures are shown in table \ref{Table:Summary of centrality measures}. The transitivity contained 304 NA's.

The eigenvector centrality and transitivity are normalised. For some nodes the transitivity cannot be calculated (those of degree 1). There are 304 of these and the summary statistics are calculated excluding these values\footnote{an alternative is to set them to zero}. 

The centrality measures are not normally distributed see table~\ref{Table:Test for normality (Shapiro-Wilk) for centrality measures of PSP}.


\footnote{\url{source('~/RProjects/paper_xls_latex/R/centrality_summary/centrality_summary_latex.R')}}
% latex table generated in R 3.6.2 by xtable 1.8-4 package
% Mon Feb 10 14:17:12 2020
\begin{table}[ht]
\centering
\begin{tabular}{rrrrrrr}
  \hline
 & Minimum & 1st Quartile & Median & Mean & 3rd Quartile & Maximum \\ 
  \hline
Degree & $1 $ & $4 $ & $8 $ & $17.64$  & $19$ & $535$ \\ 
  Eigenvector & $1.821 \times 10^{-6}$ & $8.829 \times 10^{-3}$ & $2.194 \times 10^{-2}$ & $4.793 \times 10^{-2}$ & $5.322 \times 10^{-2}$ & $1 $ \\ 
  Betweenness & $0 $ & $43.29 $ & $317 $ & $3421.1$ & $1571.6$& $6.447 \times 10^{5}$ \\ 
  Transitivity & $0 $ & $4.376 \times 10^{-2}$ & $1.290 \times 10^{-1}$ & $1.714 \times 10^{-1}$ & $2.381 \times 10^{-1}$ & $1 $ \\ 
  Closeness & $5.702 \times 10^{-5}$ & $9.217 \times 10^{-5}$ & $9.879 \times 10^{-5}$ & $9.845 \times 10^{-5}$ & $1.058 \times 10^{-4}$ & $1.399 \times 10^{-4}$ \\ 
   \hline
\end{tabular}
\caption{Summary of centrality measures} 
\label{Table:Summary of centrality measures}
\end{table}
\todo{Global transitivity and compare}
\todo{query pull out the global measures eg degree assortativity, transitivity}


\begin{table}[h]
    \centering
    \begin{tabular}{c|c|c}
       Centrality measure  &  W& p\\
       \hline
       
       Degree  & 0.426 & $<2.2 \times 10^{-16}$ \\
       Eigenvector &0.561  & $<2.2 \times 10^{-16}$ \\
       Betweenness &0.1228& $<2.2 \times 10^{-16}$ \\
       Transitivity &0.782 & $<2.2 \times 10^{-16}$\\
       Closeness &0.9953& $<4.686 \times 10^{-09}$\\ 
    \end{tabular}
    \caption{Test for normality (Shapiro-Wilk) for centrality measures of PSP}
    \label{Table:Test for normality (Shapiro-Wilk) for centrality measures of PSP}
\end{table}

\section{Correlation of centrality measures}
Closeness centrality \todo{add this} does not follow a power law distribution per p331-332 of newman as it has a liomited distribution as the reciprocal of the shortest path length from a node to all other nodes. 
% latex table generated in R 3.6.2 by xtable 1.8-4 package
% Fri Feb 14 12:11:44 2020
\begin{table}[ht]
\centering
\begin{tabular}{rrrrrr}
  \hline
 & degree & betweenness & transitivity & closeness & kcoreness \\ 
  \hline
degree & 1.000 & 0.902 & 0.196 & 0.851 & 0.986 \\ 
  betweenness & 0.902 & 1.000 & $-0.002^*$ & 0.782 & 0.854 \\ 
  transitivity & 0.196 & $-0.002^*$ & 1.000 & 0.292 & 0.265 \\ 
  closeness & 0.851 & 0.782 & 0.292 & 1.000 & 0.872 \\ 
  kcoreness & 0.986 & 0.854 & 0.265 & 0.872 & 1.000 \\ 
   \hline
\end{tabular}
\caption{Correlation between vertex centrality measures for the post synaptic proteome network. Spearman's rho. All $p < 2.2 x 10^{-16}$ other than * $p=0.90$} 
\label{tab:Correlation between vertex centrality measures for PSP. Spearman's rho}
\end{table}



All of the centrality measures are correlated with each other other except transitivity and betweenness centrality  (table~\ref{tab:Correlation between vertex centrality measures for PSP. Spearman's rho}). Transitivity is most weakly correlated with other measures. Code \footnote{\url{source('~/RProjects/paper_xls_output/R/make_df_correlation_between_centrality_measures.R')}}

See \cite{oldham2019consistency} for correlation across networks. 

\section{Cohorts and samples}
\label{Centrality:cohorts and samples}
\todo{do correlation centrality with murine ltp group}
The population data used to test the association of centrality measures with population studies of educationbal attainment and intelligence were those described in sections~\ref{sec:cohorts from paper section} and \ref{sec:samples from paper section}


\section{Association between significant vertices}
Do there tend to be edges between significant vertices?
The induced subgraph of significant genes for Intelligence\textsubscript{Replication} is 16 vertices no edges. Simulation mean 0.60 sd 0.94 N iterations = 1000. For Education\textsubscript{Replication} it is 25 vertices no edges (simulation mean 1.51 sd 1.69). For Intelligence \textsubscript{Discovery} it is 58 vertices with 4 edges. Simulation mean 8.78 sd 5.13. For Education \textsubscript{Discovery} it is 51 vertices with 2 edges. Simulation mean 6.3 SD 4.1.

Simulation of joint results out of 1000, 100 trials
Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   1.00    4.00    6.00    5.98    8.00   14.00 
   
   max = 14/1000 = 0.014
   mean = 0.006 of getting this number of edges or fewer in 4 samples of random subgraphs eg(number of times subgraph is 0 and next is 0 or less and next is 4 or less and next is 51 or less given actual frequency 0,0,4,2 and number of samples 16,25,58,51.
   
 \subsection{Assortativity with gene score}
 
A second way in which we could see if genes within the PSP that are enriched for genetic differences in education and intelligence globally within the PSP would be to calculate the correlation between there being and edge between two vertices and the significance score of the two vertices. A positive result would suggest that more significant (avoiding a cutoff effect) genes have protein products that are more likely to interact in the PSP graph. We can do this by calculating the assortativity as described by Newman. As a measure of significance we use the z score for each gene in the PSP for each study as provided by MAGMA. As some genes in the PSP do not have a significant number of SNPs within them they do not have a Z score as assigned by magma and these are therefore set to 0. \footnote{code \url{source('~/RProjects/centrality/R/get_gene_scores/assortativity_with_z_scores.R')} }

\subsubsection{Assortativity with z score results}
 
 \begin{table}[]
     \centering
     \begin{tabular}{ccc}
     \toprule
         Study & Missing values  & Assortativity\\
         \midrule
         Intelligence\textsubscript{Replication} & 148 & 0.003\\
         Education\textsubscript{Replication} & 172 & -0.006\\
         Education\textsubscript{Discovery} & 156 & 0.001\\
         Intelligence\textsubscript{Discovery} & 156 & -0.004\\
         \bottomrule
     \end{tabular}
     \caption{Assortativity of PSP graph vertices by study Z score. PSP graph members without corresponding Z score marked as missing values had z set to 0.}
     \label{tab:Assortativity of PSP graph and z scores}
 \end{table}


The results are shown in table\ref{tab:Assortativity of PSP graph and z scores}. Assortativity scores tend to me modest (as score of approximately 0.15 is often found for degree assortativity). These results are close to zero. 

This suggests that nodes with high or low z scores in the population cohorts are no more likely to have links to one another \textit{globally} across the network. It does not state that there cannot be areas within the graph where there are areas of high assortativity or areas where one high score connects to linker node connects to another high score in a group.

\todo{do this with pli too and for a phenotype eg GO glutamate}
\section{Degree}
\label{sec:degree}

Probably the simplest centrality measure is degree. 
%from \url{/home/grant/Dropbox/PhD_latex_master}
The degree of a node is the number of edges connected to it. In the network graph of the PSP it is the number of proteins a particular protein interacts with.
For the adjacency matrix $A_{i,j}$, where $A_{i,j}=1$  if there is an edge between nodes $i$ and $j$ and 0 otherwise, the degree of node $i$, $k_i$ is\cite{boccaletti2006complex}:
\begin{equation}
k_i = \sum_j \mathbf{A}_{i,j}.
\label{Equation:Degree_from_adjacency}
\end{equation}

 Nodes with high degree may have more influence in a graph and are often referred to as hubs. Note however there are two senses in which the term hubs may be used (see p 168 Newman book\cite{newman2018networks}).  In a social network  individuals with a large number of contacts will have high degree and hence be influential in the network. In a protein protein interaction network high degree proteins will have numerous interactions and one would hypothesise play an important part in the network. 
 
 Disruption of high degree notde leads to disproportionate effects upon a network \todo{cite Jeong and also cite attack tolerance}
\todo{Sort out removed citations because of undefined control}

\subsection{Degree distribution}
\label{sec:degree distribution}
The properties of networks can be discovered by comparing these networks to random models. 
If a graph were to have a random distribution of edges between vertices we would expect the degree distribution ($P(k)=k)$) to be distributed according to the binomial distribution.  

If there is a constant probability $p$ of an edge between two nodes in a network, the probability of having $k$ links with probability of links between vertices of $p$ is $p^k$ and the remaining $N-1-k$ nodes being absent (-1 as we exclude self loops) is $(1-p)^{N-1-k}$.

There are $\binom{N-1}{k}$ ways in which this arrangement of present and missing edges can be arranged so the probability follows the binomial distribution.

\begin{equation}
   \binom{N-1}{k}        p^k (1-p)^{N-1-k}
   \label{Equation:BinomialDistributionForDegreeProbability}
\end{equation}
In the limit where $E[k] << N$ the degree is well approximated by a Poisson distribution \cite{barabasi2016network}. ie the probability mass should be centred around the empirical mean and we would not expect to see nodes whose degree were 3 x or more the average degree. This is not what we find the distribution is scale free. \todo{probablility of max degree node} 



\subsection{Scale free}
\todo{intro to scale free}
We can calculate the $\gamma$ coefficient for the degree distribution using the \texttt{poweRlaw} package for R. The value of $\gamma$ will vary over the distribution depending on the lower limit of degree used to fit the power law distribution. This is shown graphically in figure \ref{fig:gamma} and table \ref{table:gamma}.

Using the method described by \cite{clauset2009power} and calculating the minimum x value we find the min for $x$ to be 24 and the $\gamma$ coefficient to be 2.51 using the poweRlaw R package \cite{gillespie2015fitting}. The log of the degree distribution is shown in figure \ref{fig:log_degree_distribution} and figure \ref{fig:Degree distribution of post synaptic proteome. Log10 - log10 scale.}
% see http://127.0.0.1:21133/library/poweRlaw/doc/a_introduction.pdf
\footnote{code at \url{/home/grant/RProjects/PhD_graphs/}}

% \begin{figure}
%   \includegraphics[width=\linewidth]{./dependence_of_scale_coefficient_on_min_degree.png}
%   \caption{The parameter $\gamma$ as a function of the degree at which calculation of the coefficient starts in the degree sequence(e.g. all degree $>5$) from \url{RProjects/PhDGraphs/calculate/gamma}} 
%   \label{fig:gamma}
% \end{figure}

% \begin{figure}
%   \includegraphics[width=\linewidth]{plot_log_degree_distribution.png}
%   \caption{The plot of log cumulative cdf of degree distribution log 10 scale x and y}
%   \label{fig:log_degree_distribution}
% \end{figure}


\begin{figure}
    \centering
    \begin{subfigure}[t]{0.45\textwidth}
        \centering
        \includegraphics[width=\linewidth]{images/dependence_of_scale_coefficient_on_min_degree.png} 
        \caption{The parameter $\gamma$ as a function of the degree at which calculation of the coefficient starts in the degree sequence(e.g. all degree $>5$) from \url{RProjects/PhDGraphs/calculate/gamma}} \label{fig:gamma}
    \end{subfigure}
    \hfill
    \begin{subfigure}[t]{0.45\textwidth}
        \centering
        \includegraphics[width=\linewidth]{images/plot_log_degree_distribution.png} 
        \caption{The plot of log cumulative cdf of degree distribution log 10 scale x and y} \label{fig:log_degree_distribution}
    \end{subfigure}
    \caption{Plots of degree distribution \textcolor{red}{may want to do this in subfigure packages rather than subcaption to line up edges}}
\end{figure}
% latex table generated in R 3.4.4 by xtable 1.8-4 package
% Sat Oct  5 16:31:0\begin{document}

\begin{table}[ht]
\centering
\begin{tabular}{lr}
  \hline
  from degree $k$ & coefficient $\gamma$ \\ 
  \hline
1 & 1.38 \\ 
  5 & 1.81 \\ 
  10 & 2.10 \\ 
  15 & 2.30 \\ 
  20 & 2.43 \\ 
  25 & 2.51 \\ 
   30 & 2.52 \\ 
  35 & 2.54 \\ 
   40 & 2.54 \\ 
   45 & 2.60 \\ 
  50 & 2.63 \\ 
   60 & 2.60 \\ 
   70 & 2.72 \\ 
   80 & 2.80 \\ 
   90 & 2.90 \\ 
   100 & 2.92 \\ 
  150 & 2.88 \\ 
   200 & 3.44 \\ 
   250 & 3.90 \\ 
  300 & 5.04 \\ 
   350 & 5.51 \\ 
   400 & 6.33 \\ 
   \hline
\end{tabular}
\caption{The $\gamma$ as a function of the degree sequence start (e.g. all degree $>5$). from RProjects/PhDGraphs}
  \label{table:gamma}
\end{table}

\subsection{Comparison of degree distribution to random erdos graph}
See section~\ref{sec: intro_random_graphs}
\todo{Comparison of degree to random graph with same p}

Add a histogram here and the expected mean and quartiles.

\subsection{Degree assortativity}
Explain assortativity

Equation assortativity

\label{sec:degree assortativity}
We can compare the average degree with those found in other publications. We can also look at the assortativity between nodes for degree. The PSP networks shows evidence of some negative degree assortativity (-0.18) using the commands \texttt{assortativity(g,deg,directed=FALSE)} in igraph for R \todo{Assortativity for essential and id}.

The degree association is negative in most real world networks other than social networks \cite{newman2002assortative}. \todo{include the peel multiscale mixing patterns} see table \ref{Table:DegreeAssortativityNewman}\todo{? add positive $r$ to table}. Both the Barabsi Albert model and random model have 0 correlation. The Callaway model of network generation ('grown graph' - newman) has a positive degree correlation consistent with older nodes being connected to each other and hence in turn being more likely to be connected to others. This is at odds with our later finding (see orthologues) that nodes with clearly identified yeast orthologues tend to be of higher degree (this would fit both the Barabasi Albert model and Callaway) \todo{Do i add the pseudo hub bit here this is also probably good for the paper with Keith}. 

The assortativity suggests that the Barabasi Albert model is 'incomplete' as a model of the internet \cite{newman2002assortative} and in this network we also find evidence that our synaptic protein protein interaction has similar degree assortativity to that calculated by Newman which is of the yeast interactome (cite Jeong) . The reasons for this are not clear, there are other things in our study that support the Barabasi model and it may be that multiple processes are taking place. \todo{? move this to discussion}

The value of $r$ of -0.18 \todo{three sf} is similar to those cited by Newman \cite{newman2002assortative} in table \ref{Table:DegreeAssortativityNewman}. 

Although we expect the assortativity to be 0 in a random graph of the configuration model (the edges are placed at random so we would not expect there to be any association with edges and the degree of vertices), there will nevertheless be a deviation from 0 due to chance and it is helpful to quantify the assortativity by calculating this. 

The assortativity using a configuration model is approximately normal centred on 0.

For 10,000 samples   

Min.    1st Qu.     Median       Mean    3rd Qu.       Max. 
-2.142e-02 -3.811e-03 -1.743e-05  5.524e-05  3.861e-03  2.235e-02 

Shapiro-Wilk normality test

data:  results[1:500]
W = 0.99538, p-value = 0.1446


\begin{table}[]
    \centering
    \begin{tabular}{c|c|c}
       network  &N& $r$  \\
       \hline
       internet & 10697&-0.189\\
       world wide web &269504 & -0.065\\
       post synaptic proteome & 3457 & -0.18\\
       protein interactions & 2115 & -0.156\\
       neural network & 307 & -0.163\\
       food web & 92 & -0.276 \\
       
       
         
    \end{tabular}
    \caption{Degree assortativity coefficients of networks adapted from Newman 2002 \cite{newman2002assortative} including post synaptic proteome}
    \label{Table:DegreeAssortativityNewman}
\end{table}

%\subsubsection{Degree correlation}
 
\todo{Include \url{R_plot_degree_correlation.png} commented out}


Newman \cite{newman2018networks} p336 cites Maslov \cite{maslov2004detection} as giving as a reason for the disassortative nature of many empirical networks the prohibition on multi-edges. The expected number of multiedges between nodes would be greater than one (need to look at the paper again).

This is possibly the bit where Keith's bit would be good to put in.  
 %\begin{figure}]h]
 % \includegraphics[width=\linewidth]{Rplot_degree_correlation.png}
 % \caption{Plot of degree with k nearest neighbour mean of degree}
 % \label{fig:knn_degree}
%\end{figure}
%
%
%
\subsection{Degree and giant component}
\label{sec:connected component and degree}
Some structure can develop even in random graphs see~\ref{sec: intro_random_graphs}
\todo{Change this as below subcritical, supercritical, fully connected} CHANGE this
Subcritical to supercritical at $<k> >1$


Supercritical to fully connected at $E[k] > \ln(N)$


Where $N$ is the number of nodes in a network, a giant connected component develops in random graphs when $E[k] > \ln (N)$ \cite{barabasi2016network}. This tends to be the case in real world complex networks. The necessary requirement for a connected component to form is that mean degree is greater than $1/N$. The giant connected component arises in the super-critical' region (see \cite{barabasi2016network} p87). For the PSP $E[k]$ is 17.6 and $\ln(N)=\ln(3457)=8.14$. It is important to note however that the degree distribution for the PSP graph is not that of a random network ($P(k)$ is scale free it would also be unlikely to find many nodes $ 3 \times E[k]$, if it were there would be few nodes with degree 2 and we find some nodes disconnected from the connected component in our empirical model. \todo{cross ref to missing nodes I think it is in the paper section so community detection} \todo{Add plot from \url{'~/RProjects/graph_analysis/R/transitiontoconnectederdosrenyi.R'} for transition from sub-critical to super-critical region} see section~\ref{sec: PSP graph connected component and missing} for missing components.


\subsection{Degree and intelligence in PSP}
We will see what the correlation is in population cohorts and what we might expect it to be given the effects of high degree genes in model animals. 
\todo{This is perhaps the bit to introduce the possible different hypothesise}

\subsection{The characterisation of high degree nodes}
Are nodes of high degree different to the rest of the PSP in terms of function. 

% latex table generated in R 3.6.2 by xtable 1.8-4 package
% Sat Jan  4 12:23:24 2020
\begin{table}[ht]
\centering
\scalebox{0.8}{
\begin{tabular}{rrll}
  \hline
Entrez & Degree & Symbol & Description \\ 
\hline
351 & 535 & APP & amyloid beta precursor protein \\ 
  2335 & 474 & FN1 & fibronectin 1\footnote{Fibronectin lethality} \\ 
  1994 & 473 & ELAVL1 & ELAV like RNA binding protein 1 \\ 
  1956 & 450 & EGFR & epidermal growth factor receptor \\ 
  7514 & 396 & XPO1 & exportin 1 \\ 
  10482 & 375 & NXF1 & nuclear RNA export factor 1 \\ 
  7316 & 363 & UBC & ubiquitin C \\ 
  26270 & 342 & FBXO6 & F-box protein 6 \\ 
  7412 & 327 & VCAM1 & vascular cell adhesion molecule 1 \\ 
  55832 & 316 & CAND1 & cullin associated and neddylation dissociated 1 \\ 
  8454 & 316 & CUL1 & cullin 1 \\ 
  2885 & 313 & GRB2 & growth factor receptor bound protein 2 \\ 
  7534 & 298 & YWHAZ & tyrosine 3-monooxygenase tryptophan 5-monooxygenase \\
  3320 & 266 & HSP90AA1 & heat shock protein 90 alpha family class A member 1 \\ 
  10075 & 263 & HUWE1 & HECT, UBA and WWE domain containing 1, E3 ubiquitin protein ligase \\ 
  4869 & 263 & NPM1 & nucleophosmin 1 \\ 
  7415 & 245 & VCP & valosin containing protein \\ 
  3178 & 227 & HNRNPA1 & heterogeneous nuclear ribonucleoprotein A1 \\ 
  22938 & 221 & SNW1 & SNW domain containing 1 \\ 
  8453 & 221 & CUL2 & cullin 2 \\ 
   \hline
\end{tabular}
}
\caption{The 20 post synaptic proteome genes with highest degree in their cognate proteins.NOTE tablewidthmodifiedusingscalebox. Code to generate table at \url{source('~/RProjects/gridsearch_gamma/R/degree_distribution.R')}} 
\label{Table:The 20 post synaptic proteome genes with highest degree in their cognate proteins.}
\end{table}
Table \ref{Table:The 20 post synaptic proteome genes with highest degree in their cognate proteins.} shows the 20 post synaptic proteome genes with highest degree and their associated degree. 7 of these genes are part of the ubiquitin protein binding process. \todo{Add class analysis panther}


\begin{figure}
    \includegraphics[width=12cm]{Rplot_DegreeDistribution}
    \caption{Degree distribution of post synaptic proteome. Log10 - log10 scale. Code at \url{source('~/RProjects/gridsearch_gamma/R/plot_log_degreedist.R') }}
    \label{fig:Degree distribution of post synaptic proteome. Log10 - log10 scale.}
\end{figure}

\subsection{Degree and Gene Ontology enrichment}

Using the 95th centile of degree distribution (59) we obtained 165 genes. Gene ontology enrichment analysis shows that they are over represented compared with the rest of the proteome for tau protein binding, ubiquitin pathways and cadherin binding.

\subsection{Enrichment compared to PSP}

Using SLIM ontology enrichment was found compared to the rest of the PSP for the biological process (table~\ref{tab:GO SLIM ontology enrichment Biological Process background PSP})

\begin{table}
\centering
\begin{adjustbox}{max width=\textwidth}
\begin{tabular}{llllllllll}
Name & Ontology ref &ref &	expected &	Fold Enrichment &	+/-	&raw P value&FDR\\
\hline
ubiquitin protein ligase & GO:0031625&  	7 &  	.74 & 	9.48 &  	+ & 	$5.08\times 10^{-05}$ & 	$2.43 \times 10^{-02}$\\
\end{tabular}
\end{adjustbox}
\caption{GO SLIM ontology enrichment Biological Process background PSP}
\label{tab:GO SLIM ontology enrichment Biological Process background PSP}
\end{table}



SLIM Biological process was enriched for ubiquitin protein ligase (table~\ref{tab:GO SLIM ontology enrichment Biological Process background PSP})
\todo{redo some of these to check}
\begin{table}
\centering
\begin{adjustbox}{max width=\textwidth}
\begin{tabular}{l l l l l l l l l l}
Name & Ontologyref &ref & set&	expected &	Fold Enrichment &	+/-	&raw P value&FDR\\
\hline
proteasome-mediated ubiquitin-dependent &GO:0043161 & 48 & 	12 &	2.73 &	4.40 & 	+ & 	6.27E-05 & 	4.98E-02 \\
protein catabolic process\\
cell cycle& GO:0007049&	175 	&26 &	9.94& 	2.61 &	+ & 	3.29E-05& 5.22E-02\\
\end{tabular}
\end{adjustbox}
\caption{GO SLIM Biological process High degree nodes}
\label{tab: high degree slim biological process}
\end{table}

\subsubsection{Cellular compartment GO SLIM}
GO SLIM cellular compartment revealed enrichment for intra-nuclear organelles (table~\ref{tab: high degree slim cellular compartment}).

\begin{table}
\centering
\begin{adjustbox}{max width=\textwidth}
\begin{tabular}{llllllll}
  Name  &ref &set &	expected &	Fold Enrichment &	+/-	&raw P value&FDR\\
\hline
nucleus &	459& 	50& 	26.08& 	1.92& 	+ &	$1.60\times 10^{-05}$& 	$6.67\times 10^{-03}$\\
intracellular membrane-bounded organelle&	489&	51&	27.79&	1.84&	+&	$4.21\times10^{-05}$ &	$8.78\times 10^{-03}$\\
intracellular organelle&	490&	51&	27.84&	1.83&	+&	$4.31\times 10^{-05}$&	$5.98\times10^{-03}$\\
\end{tabular}
\end{adjustbox}
\caption{High degree GO SLIM cellular compartment}
\label{tab: high degree slim cellular compartment}
\end{table}

\subsubsection{Molecular function full}
Ontology enrichment of the full molecular function revealed enrichment of the WNT signolosome too
\begin{table}
\centering
\begin{adjustbox}{max width=\textwidth}
\begin{tabular}{l l l l l l l l}
Name  &ref & set&	expected &	Fold Enrichment &	+/-	&rawPvalue&FDR\\
\hline
Wnt signalosome& 	7& 	5& 	.40& 	12.57&	+ &	$2.51\time10^{-04}$& 	$8.15\times10^{-03}$\\ 
\end{tabular}
\end{adjustbox}
\caption{Molecular function. Full set ie not go slim ? PSP}
\label{tab:Molecular function. Full set ie not go slim ? PSP}
\end{table}

5 of the 7 elements of the signalosome are in the core segment and there are only 12 in the genome altogether.

\subsection{GO SLIM enrichment against all genome} 

\subsubsection{Cellular compartment }
See table~\ref{tab:Cellular component high degree GO SLIM against genome}
\begin{table}
\centering
\begin{adjustbox}{max width=\textwidth}
\begin{tabular}{lllllllll}
  Name & GO&	Homo sapiens &ref &	expected &	Fold Enrichment &	+/-	&raw P value&FDR\\
  COP9 signalosome&GO:0008180&	13&	3&	.16&	18.35&	+&	9.41E-04&	2.81E-02\\
  microtubule cytoskeleton &GO:0015630&	335&	13&	4.21&	3.09&	+&	4.40E-04&	1.64E-02\\
\end{tabular}
\end{adjustbox}
\caption{Cellular component high degree GO SLIM against genome}
\label{tab:Cellular component high degree GO SLIM against genome}
\end{table}

\subsubsection{Molecular function}
See table~\ref{tab:Molecular function high degree GO SLIM against genome}
\begin{table}
\centering
\begin{adjustbox}{max width=\textwidth}
\begin{tabular}{lllllllll}
  Name & GO&	Homo sapiens &ref &	expected &	Fold Enrichment &	+/-	&rawPvalue&FDR\\
  \hline
ubiquitin protein ligase binding&GO:0031625&	34&	7&	.43&	16.37&	+&	6.59E-07&	1.66E-04\\
\end{tabular}
\end{adjustbox}
\caption{Molecular function high degree GO SLIM against genome}
\label{tab:Molecular function high degree GO SLIM against genome}
\end{table}

\subsubsection{Biological process}
Biological process bit of mixed bag nothing interesting 

\footnote{text files in \url{/home/grant/RProjects/gridsearch_gamma}}

\section{Degree and essentialness}
\label{sec:Degree and essentialness}
Jeong \cite{jeong2001lethality} examined the correlation between a gene being essential and having high degree in the proteome of \textit{Saccharomyces ceresvisiae} having 1870 nodes and 2240 interactions (comparatively sparse compared with the synaptic proteome). They found that elimination of the most connected nodes led to an increase in network diameter and that the likelihood that mutation in a protein would prove fatal was correlated with degree, They found that 21\% of the nodes with degree less than 5 (93\% of the proteome). Although 0.7\% of yeasts with more than 15 links had phenotypic profile 62\% of these were lethal.


Raman \cite{raman2014organisational} examined multiple centrality metrics in addition to degree (degree, betweenness centrality, closeness centrality and pairwise dis-connectivity index) and their association with gene essentiality for 20 organisms.

 Using the STRING database filtered for high quality interactions they found a disassortative pattern of connection of essential genes (they did not appear to be connected to each other)  (compare with section~\ref{sec:degree assortativity})  and found higher than average degree and betweenness centrality (greatest for degree centrality). The organisms that they studied (20) were mostly bacteria and yeasts, no most sophisticated I could see was \textit{Caenorhabditis elegans}. They also calculated what fraction of essential nodes had a higher degree than n where n is a centile of the degree distribution).
 
 \todo{Assortativity of essential nodes in PSP}
 \todo{difference plI and DEG}
 
 \subsubsection{Database of essential genes}
 \label{sec:Database of essential genes}
 
 
 The database of essential genes is found at \url{www.essentialgene.org}. Downloading essential eukaryote genes yields 34590 entries.
 
 Data is available for 9 clades:  Saccharomyces cerevisiae   ,Caenorhabditis elegans,Arabidopsis thaliana,Danio rerio,Mus musculus,Homo sapiens,
 Drosophila melanogaster,Aspergillus fumigatus and Schizosaccharomyces pombe 972h-.
 
 Data on 28286 human genes are recorded. 8256 unique gene ids are found for human genes. Human genes are identified by HGNC id code \footnote{\url{source('~/RProjects/paper_xls_latex/R/essentail_genes/load_essential_genes.R')}}.
 
 Entrez id were obtained using the module \url{convert_gmx_private}\footnote{ at \url{/home/grant/PycharmProjects/convert_gmx_private}}.
 
 This uses downloaded gene info from entrez gene to find first the symbol and if that is missing to search through synonyms and supply the matching entrez id. It returns a list of items not found. 
 
8284 genes were translated to entrez id. 8 ids could not be identified. 3 of these are recorded as dates in the primary data \footnote{(5,6 Mar, 5 Sep)}
 
 The dataframe of conversions are stored in the supplemental data\footnote{ \url{/home/grant/RProjects/paper_xls_latex/data/essential_genes.tsv}}

2241 genes in the PSP are essential (64.8\%)

This compares with 37.\% of the genome as a whole (assuming 20000 genes \todo{get non essential number from database}. 36.5\% (6043/20000) non PSP genes are essential. 

\todo{Degree etc for essential genes}
\todo{Essential genes enrichment vs non essential PSP add to community detection section}
\todo{Essential gene count for significant genes vs psp genes}

 \subsubsection{Degree distribution of PSP genes - murine model}
 
 We can use the mouse phenotype ontology to identify essential murine genes. 
 We want to know if high degree PSP nodes are more commonly associated with essentiality in murine models. 
 
 The 90\% centile for PSP gene degree is $k=37$. 349 genes in the PSP network model have degree $k>=37$.
 
 Murine phenotype MP:008763 is embryonic lethality. 117 of the genes with degree $k>=37$ are essential (33.5\% of 349 genes). 458 genes are essential in the remaining PSP nodes ($k < 37$, 458 of 3108 14.7\%). p $3.13 \times 10^{-11}$ Fisher's exact test for count data R. Odds ratio 2.27 95\% CI 1.79-2.88. \footnote{code:\url{/home/grant/RProjects/phenome_and_network/R/get_degree_90_quantile_PSP.R}} \todo{Calculate difference in degree for essential versus not essential} Comment \todo{one reason for testing the top 10\% is that the degree distribution is of a few hubs (cite Jeong) with different properties from the rest given the scale free structure of the network}
 
 \begin{table}[h]
     \centering
     \begin{tabular}{llllll}
          Title & $k$& n essential & n & percentage essential & p   \\
          \hline
          Top 10\% & $>=37$ & 117 & 349 & 33.5 & $3.13 \times 10^{-11}$\\
          Rest & $<37$ & 458 & 3108 & 14.7 & \\
     \end{tabular}
     \caption{Association of high degree nodes with being essential in murine models. Genes with degree in top 10\% of PSP compared with the rest. P Fisher's Exact Test for Count data.}
     \label{Table:Degree and murine essentialness PSP}
 \end{table}
 

\todo{GO enrichment with background PSP for high degree are in \url{/home/grant/Dropbox/stront_share/data/GO\_high\_degree_psp_background}}




\subsection{Degree and orthologs}

If the network is generated by the preferential attachment model of Barabasi we would expect the nodes of high degree to have more ancient orthologues than those of higher degree. Another generating function of the graph is likely to be duplication divergence as we know there was a genome duplication event nevertheless we could hypothesise that the nodes with yeast orthologues will have higher median degree than the human and murine PSP. \todo{add cross ref to orthologues}

\section{Probability of loss of function intolerance (pLI)}

\todo{Remove takehome} \subsubsection{Takehome: Remove}

The probability of loss of function intolerance is associated with measures of vertex centrality in the post synaptic proteome graph. The correlation is greatest for degree ($\rho=0.230$) and lowest for transitivity ($\rho=0.086$). Betweenness and eigenvector centrality have similar correlation to loss of function intolerance as degree (see table \ref{Table:Correlation of pLI with centrality vertex statistic})

\subsection{Loss of function and evolutionary pressure}

The Exac database is a compendium of data from the exomes of over 60,000 individuals \cite{lek2016analysis}. It permits the calculation of the frequency of mutations in specific genes. In addition there is a background mutation rate that is observed in human genes. If there is a lack of mutations in a specific region then we can conclude that the organism is intolerant to such mutations. The researchers provide a statistic the probability of loss of function intolerance that provides a measure of how much purifying selection a gene is under. The file was downloaded from 
\url{"https://storage.googleapis.com/gnomad-public/legacy/exac_browser/forweb_cleaned_exac_r03_march16_z_data_pLI_CNV-final.txt.gz"}

\subsubsection{Processing and cleaning Exac data for PSP}
\todo{query move to supplemental methods}
The data consists of 18282 rows and 23 columns. A variety of metrics are available to measure the frequency of synonymous mutations, non synonymous mutations and missense mutations. The authors recommend the use of the probability of loss of function mutation metric as this takes into account variations in gene size which some other metrics may be biased by. In addition the rows were identified by Ensembl transcript ID, HUGO gene symbol and contained information on the number of base pairs, chromosome number and location on the chromosome. This data is recorded in supplementary section~
\ref{sec:supplemental data table for exac}.


% raw output for ref
%[1] "gene"       "chr"        "n_exons"    "tx_start"   "tx_end"    
% [7] "bp"         "mu_syn"     "mu_mis"     "mu_lof"     "n_syn"      %"n_mis"     
%[13] "n_lof"      "exp_syn"    "exp_mis"    "exp_lof"    "syn_z"      "mis_z"     
%[19] "lof_z"      "pLI"        "n_cnv"      "exp_cnv"    "cnv_z"     
% end

114 duplicated entries with duplicated Ensembl transcript id were identified. Each was duplicated twice with identical transcript id and entrez gene ID (duplicate of 57 entries) see table~\ref{tab:Supplementary table- duplicate exac data}. The duplicates were identical other than different numbers of copy number variations (CNV) recorded. As the analysis was not going to include CNV these were discarded.  \textcolor{red}{this matches the redo}\footnote{code \url{('~/Rprojects/paper_xls_output/R/download_exac.R')}}.


Entrez ID were obtained by joining the Exac data to the human gene info 

% The genes were identifiable from both transcript ID ENST, and HGNC gene symbol. (18282 - 57) 18225 distinct transcripts and gene symbols were identified.

% 57 transcript id and gene ID were duplicated and removed  There were 114 duplicated entries (i.e. each was duplicated twice). For all duplicates all statistics were identical of than number of copy number variations, expected number of copy number variations and z score for copy number variations. 
% \todo{move into separate function}

% As we were not using CNV these were eliminated

To obtain entrez ID we join the Exac data to the human gene info downloaded from entrez. This joined table has 8 duplicates as a result of Exac gene symbols mapping to more than one entrez ID)

One synaptic gene is found in the duplicated list HBD Gene ID 3045 which also has the entrez ID 100187828 
HBD
the transcript is ENST00000380299.3 which is haemaglobin delta maps to ENSG00000223609

there is also Hypophosphataemic bone disease which is 100187827 but the one that is present in the synapse is 3045


Code for the extraction and processing of the loss of function intolerance data was as follows 
\url{~/RProjects/paper_xls_output/R/download_exac.R}

3235 genes of the PSP have exac data. The missing 222 have insufficient coverage. The missing ones are shown in supplemental table x.
Lookup on \url{https://grch37.ensembl.org/Multi/Search/Results?q=ENST00000404774.3;site=ensembl_all}

MEMO1 mediator of cell motility Entrez 7795 (Methylation modifier for class I HLA
) and 51072(correct)

MMD2 monocyte to macrophage 221938 MMD2 100505381 (Miyoshi Muscular Dystrophy 2 – wrong)

TEC tec Protein tyrosine kinase 7006 not 100124696 (Transient erythroblastopaenia of childhood)

There are 14990 non synaptic genes with exac information and a total of 18225 \textcolor{red}{18070 in redo} genes with exac gene info

\subsection{Distribution of pLI}
\todo{Distribution of pLI}


% latex table generated in R 3.6.2 by xtable 1.8-4 package
% Sat Jan 11 15:09:57 2020
\begin{table}[ht]
\centering
\begin{adjustbox}{max width=\textwidth}
\begin{tabular}{rllrrrl}
  \hline
 & Study & Graph statistic & S & p & rho & Test \\ 
  \hline
1 & Intelligence Discovery & pLI & $5.400 \times 10^{9}$ & $1.10 \times 10^{-6}$ & -0.087 & Spearman's rank correlation rho \\ 
  2 & Intelligence Replication & pLI & $5.200 \times 10^{9}$ & $1.07 \times 10^{-2}$ & -0.046 & Spearman's rank correlation rho \\ 
  3 & Education Discovery & pLI & $5.600 \times 10^{9}$ & $1.38 \times 10^{-11}$ & -0.120 & Spearman's rank correlation rho \\ 
  4 & Education Replication & pLI & $5.200 \times 10^{9}$ & $1.54 \times 10^{-4}$ & -0.068 & Spearman's rank correlation rho \\ 
   \hline
\end{tabular}
\end{adjustbox}
\caption{Correlation of GWAS gene level statistics Spearman's rho gene pLI} 
\label{Table:Correlation of GWAS gene level statistics Spearmans rho gene pLI}
\end{table}

% latex table generated in R 3.6.2 by xtable 1.8-4 package
% Fri Mar  6 15:52:12 2020
\begin{table}[ht]
\centering
\begin{adjustbox}{max width=\textwidth}
\begin{tabular}{llrrr}
  \hline
study & comparison & rho & S & p \\ 
  \hline
Intelligence Replication & all Zstat and pLI & 0.043 & 797235155436.9 & $2.358 \times 10^{-8}$ \\ 
  Intelligence Replication & synaptic Zstat and pLI & 0.042 & 5465708502.3 & $1.661 \times 10^{-2}$ \\ 
  Intelligence Replication & non synaptic Zstat and pLI & 0.033 & 428265764841.3 & $1.249 \times 10^{-4}$ \\ 
  Education Replication & all Zstat and pLI & 0.065 & 749149170637.4 & $4.370 \times 10^{-17}$ \\ 
  Education Replication & synaptic Zstat and pLI & 0.070 & 5198989756.7 & $6.926 \times 10^{-5}$ \\ 
  Education Replication & non synaptic Zstat and pLI & 0.059 & 398992399833.6 & $6.604 \times 10^{-12}$ \\ 
  Intelligence Discovery & all Zstat and pLI & 0.066 & 778515153123.3 & $8.384 \times 10^{-18}$ \\ 
  Intelligence Discovery & synaptic Zstat and pLI & 0.078 & 5218943442.6 & $7.746 \times 10^{-6}$ \\ 
  Intelligence Discovery & non synaptic Zstat and pLI & 0.048 & 422374139606.0 & $1.396 \times 10^{-8}$ \\ 
  Education Discovery & all Zstat and pLI & 0.093 & 755468138230.8 & $2.195 \times 10^{-34}$ \\ 
  Education Discovery & synaptic Zstat and pLI & 0.117 & 5003003452.8 & $2.793 \times 10^{-11}$ \\ 
  Education Discovery & non synaptic Zstat and pLI & 0.071 & 412373757794.5 & $7.820 \times 10^{-17}$ \\ 
   \hline
\end{tabular}
\end{adjustbox}
\caption{Extra table to be removed shows spearman for all synaptic and non synaptic and all but rho is with pLI and zstat not -log10 and -log10 of p  so rho is positive ie}
\label{tab:Extra table to be removed shows spearman for all synaptic and non synaptic and all but rho is with pLI and zstat not -log10 and -log10 of p  so rho is positive ie}
\end{table}

There was a weak association between probability of loss of function intolerance and gene score in this case z score. In table \ref{Table:Correlation of GWAS gene level statistics Spearmans rho gene pLI} the correlation is shown with the negative log10 transform of the p value and so $\rho$ is negative. Fuller results are shown in table ~\ref{tab:Extra table to be removed shows spearman for all synaptic and non synaptic and all but rho is with pLI and zstat not -log10 and -log10 of p  so rho is positive ie}  \footnote{\url{source('~/RProjects/paper_xls_output/R/make_df_correlation_pLI_genescore.R')}} the relationship is stronger for synaptic genes than for non synaptic genes although the effect is small and synaptic genes as shown below have a higher probability of loss of function intolerance.

There was a positive correlation between loss of function intolerance and the gene Z stat. To be explicit the Z stat is high and positive when the gene has a more significant association with the phenotype and hence a lower p value. There is a weak association between high loss of function intolerance and significant (low p value genes)

\todo{there is something wrong here as Jan we find correlation} 
 In testing correlation spearman’s rank correlation was used as the distribution of the probability of loss of function intolerance statistic is very non linear. It has a bi-modal distribution (see figure~\ref{fig:density estimate pLi} with a concentration of probability mass around 0 and 1 .


The distribution of probabilitity of loss of function intolerance in non PSP genes is still bimodal but the probability mass around 1 is much less peaked and there is greater mass at the bottom of the distribution (see figure~\ref{fig:density estimate pLi two panel}. The boxplot in figure ~\ref{fig:Boxplot of pli} shows the median and means of the distributions\footnote{ Source for graphs \url{source('~/RProjects/paper_xls_output/R/plot_pli_PSP_v_restgenome.R')}}. 


\begin{figure}
    \centering
    \includegraphics[width=0.9\textwidth]{images/Rplot_kernel_density.png}
    \caption{The distribution of probability of loss of function intolerance. Kernel density estimate using Guassian kernel. Bimodal distribution with peak close to 0 and 1 for the post synaptic proteome. }
    \label{fig:density estimate pLi}
\end{figure}

\begin{figure}
    \centering
    \includegraphics[width=0.9\textwidth]{images/Rplot01_density_PSP_two_panel_nonPSP.png}
    \caption{The distribution of probability of loss of function intolerance for the post synaptic proteome (left) and the rest of the genome (post synaptic proteome removed) on the right. Kernel density estimate using Guassian kernel. Bimodal distribution with peak close to 0 and 1 for the post synaptic proteome. The peak around 1 is much smaller in the non post synaptic proteome. }
    \label{fig:density estimate pLi two panel}
\end{figure}



This code \url{source('~/RProjects/paper_xls_output/R/make_pLI_correlation.R')}
makes the table for the correlation between pLI and vertex statistics. It is the only one found in the previous hard copy so suggest \todo{Redo from scratch correlation between pLI and study p vals to confirm although findings makes sense and cannot inf any previous source code}.

The current results suggest that the relationship between the variables is as shown in the factor graph in figure \ref{Figure:Factor graph for relationship between pLI, vertex statistic and study p values}

\begin{figure}
    \centering
    \includegraphics[width=0.9\textwidth]{images/Rplot03_boxplot_pLI_PSP_non_PSP.png}
    \caption{Box plot of probability of loss of function intolerance (pLI) between PSP genes (n=) and non PSP genes (rest of genome n=14990 ). Diamond marker indicates mean PSP value. }
    \label{fig:Boxplot of pli}
\end{figure}

\begin{figure}
    \centering
    \includegraphics[width=\textwidth]{IMG_6979.JPG}
    \caption{Factor graph for relationship between pLI, vertex statistic and study p values}
    \label{Figure:Factor graph for relationship between pLI, vertex statistic and study p values}
\end{figure}
\todo{Make into table}
% latex table generated in R 3.6.2 by xtable 1.8-4 package
% Sat Jan 11 15:52:39 2020
\begin{table}[ht]
\centering
\begin{tabular}{rllrrrl}
  \hline
 & Study & Graph statistic & S & p & cor & Test \\ 
  \hline
1 & pLI & Degree & $4.300 \times 10^{9}$ & $2.00 \times 10^{-40}$ & 0.230 & Spearman's rank correlation rho \\ 
  2 & pLI & Betweenness & $4.500 \times 10^{9}$ & $1.40 \times 10^{-32}$ & 0.210 & Spearman's rank correlation rho \\ 
  3 & pLI & Eigenvector & $4.400 \times 10^{9}$ & $6.60 \times 10^{-37}$ & 0.220 & Spearman's rank correlation rho \\ 
  4 & pLI & Transitivity & $4.000 \times 10^{9}$ & $2.80 \times 10^{-6}$ & 0.086 & Spearman's rank correlation rho \\ 
   \hline
\end{tabular}
\caption{Correlation of pLI with centrality vertex statistic. Code \url{source('~/RProjects/paper_xls_output/R/get_exac_correlation.R')}} 
\label{Table:Correlation of pLI with centrality vertex statistic}
\end{table}
\subsubsection{pLI and vertex statistics}
 The   correlation between pLI and vertex statistics is shown in table table \ref{Table:Correlation of pLI with centrality vertex statistic} \footnote{ code at \url{source('~/RProjects/paper_xls_output/R/make_pLI_correlation.R')}}. This suggests that a correlation between centrality measure and loss of function intolerance where more important genes in terms of centrality measure are more likely to be intolerant of genetic change. The correlation is greatest for degree ($\rho = 0.23$) but is similar for betweenness centality and eigenvector centrality. The correlation is much weaker for transitivity. 
 
 
\subsubsection{Linear model of pLI and vertex statistics}    
A linear regression model for centrality measures and pLI was constructed \footnote{Code \url{source('~/RProjects/paper_xls_output/R/make_pLI_correlation.R')}}. Although the correlation may be similarly linear the eigenvector centrality may have more effect on the gradient of the line of the relationship. 

The eigenvector centrality seems to predict pLI best. Taking the 3rd quartile of the eigenvector centrality then the following are the summary statistics for the pLI

The genes with higher eigenvector centrality tend to have higher probability of loss of function intolerance see table~\ref{tab:pli and eigenvector centrality quartiles}

\begin{table}[]
    \centering
    \begin{tabular}{llllllll}
    \toprule
      Sample &  Min. &1st Qu.&  Median &   Mean& 3rd Qu.&    Max. &   NA's     \\
      \midrule
     Eigenvector 3rd quartile  &0& 0.349& 0.9315& 0.689& 0.998& 1&     48  \\ 
     PSP &0&0.007&0.620&0.522&0.987&  1 & 222\\
     Eigenvector less than 3rd quartile &0&0.002&0.386&0.466&0.974&1&    174\\
     \bottomrule
    \end{tabular}
    \caption{Probability of loss of function intolerance for different values of eigenvector centrality and for PSP as whole}
    \label{tab:pli and eigenvector centrality quartiles}
\end{table}
%   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's 
% 0.0000  0.3485  0.9315  0.6892  0.9983  1.0000      48 

%For the PSP as a whole this is	
%  Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's 
%0.00000 0.00719 0.61952 0.52215 0.98691 1.00000     222 

%and for the eigenvector centrality below the third quartile it is

%  Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's 
%0.00000 0.00165 0.38598 0.46570 0.97380 1.00000     174

Wilcoxon test for difference in means for all synaptic pLI and those with eigenvector centrality above the third quartile
        Wilcoxon rank sum test with continuity correction

data:  df\$pLI and joined\_df\_synaptic\$pLI
W = 1611226, p-value $< 2.2e-16$
alternative hypothesis: true location shift is not equal to 0
\subsubsection{Distribution of pLI across community groups}
\todo{Move this to community detection}
\textcolor{red}{start move to community detection}
Although there are quite disparate values for pLI across the different spectral groups especially the median value the mean is relatively stable. The mean of pLI for group 5 does not differ from that of the PSP as a whole.         Wilcoxon rank sum test with continuity correction

data:  group5\$pLI and resPSP\$pLI
W = 174757, p-value = 0.3335
alternative hypothesis: true location shift is not equal to 0

Group 5 has the fifth highest median pLI of 0.828
Summary of median of groups
    Min.   1st Qu.    Median      Mean   3rd Qu.      Max. 
0.0007318 0.2776811 0.5084966 0.5131923 0.7514292 0.9939719 \todo{move to table}

The median pLI for the whole genome is stirkingly low compared to that of the synaptic proteome (Median 0.028 vs 0.620 for synaptic). The pLI is fairly constant across orthology groups within the synaptic proteome).
\textcolor{red}{end move to community detection}

\subsection{pLI for orthologs} \url{source('~/RProjects/orthologs2/R/make_PLI_orthologs.R')}

\todo{Unite this bit with the other ortholog bit}
\todo{Check if this is synaptic and add number}
\begin{table}[ht]
    \centering
    \begin{tabular}{lcccccc}
    &                 Min.& 1st Qu. &Median& Mean& 3rd Qu.& Max.\\
yeast\_sum   &     1.3e-23& 2.5e-02&  0.710& 0.56&    0.98 &   1\\
cel\_sum     &     2.9e-40& 1.3e-02&  0.630& 0.52&    0.97 &  1\\
fly\_sum      &    9.6e-51 &1.9e-02&  0.720& 0.56&    0.99 &  1\\
zf\_sum        &   9.6e-51& 1.1e-02&  0.670& 0.53&    0.99  &  1\\
mouse\_pLI      &  5.4e-91 &6.0e-03&  0.620& 0.52&    0.99   &1\\
pli\_synaptic\_sum & 5.4e-91 &7.2e-03&  0.620& 0.52&    0.99  &  1\\
human\_genome\_plI &5.4e-91 &3.2e-05&  0.028& 0.30&    0.68  &  1\\
  
    \end{tabular}
    \caption{Distribution of pLI (probability of loss of function intolerance orthologs}
    \label{tab:pLI orthologs}
\end{table}


\section{Transitivity}

The probability the two neighbours of a node in a network are connected is its transitivity or clustering coefficient.\cite{newman2018networks}

Transitivity is calculated locally and globally. The local tranisitivity has been calculated in igraph for R for a histogram of values see figure~\ref{fig:transitivity}. The local clustering coefficient has been calculated using graph tool. The measure of local clustering coefficient follows \todo{Citation error}cite(watts1998collective) and is defined as a vertex having $k_v$ neighbours 
\begin{equation}
C = \frac{c_n}{c_{max}}
\end{equation}
where $c_n$ is the number of connections between a vertexes neighbours and $c_{max}$ is defined as 

\begin{equation}
c_{max} = \frac{k_v(1-k_v)}{2}
\end{equation}

The correlation of the log10 transform of the degree and local\_clustering is 
	Spearman's rank correlation rho

%data:  clustering_sub\$log_clustering and clustering_sub\$log_degree
S = 3670800000, p-value $< 2.2 \times 10^{-16}$
      rho= 
-0.373025 

Spearmans rho calculated as graph not linear throughout relationship see fig~\ref{fig:transitivity}.

The global undirected transitivity of the PSP network is 0.0697. This is similar to the value reported in p305 newman for metabolic networks (0.090) and PPI (0.072)\todo{check both different global formulae in newman}.

The expected value of the global clustering coefficient with a given degree distribution connected randomly \cite{newman2018networks} p332 is:
\begin{equation}
    C=\frac{1}{n}\frac{[<k^2> - <k>]^2}{<k^3>}
\end{equation}

The value of this for the PSP is 0.004541763 \footnote{code \url{source('~/RProjects/centrality/R/transitivity/Expected_global_transitivity.R')}}. The global clustering coeffieicnet is therefore high. Newman states p334 \cite{newman2018networks} that it is not clear why certain non social networks have higher than expected global clustering (for social networks it is ascribed to social choice). For other networks such as the internet with very right skewed degree distribution the clustering coefficient is less than expected. For biological systems such as foodwebs or the world wide web it is hypothesised that this may due to community formation (newman ref 367)

Also motifs (other than number of triangles) newman 334 again

\subsubsection{Local clustering coefficient}
Local cluistering coefficeint tends to be inversely proportional to degree. It is undefined for nodes of degree one. See~figure \ref{fig:log_transitivity_degree}. It is suggested that this may also be due to community formation \cite{newman2018networks} p335.

Mean local transitivity is 0.171. The distribution is right skewed with median of 0.129 and 3rd quartile of 0.23 and first quartile of 0.043. This does not match the arithmetic mean of vertex local clustering below it may be down to how we deal with NA. Above calculated as NA.rm

The global clustering as defined by Watts and Strogatz as the arithmetic mean of the vertex local clustering coefficients is 0.156.\cite{watts1998collective} this is the value if you set NA ie degree 1 to 0 and 0.171 is the value using NA.rm see above section. 

The expected value of local clustering given a random rewiring with fixed degree distribution is 0.07479691 sd (0.00183) removing NA and 0.068 setting NA to 0 (100 iterations) and 0.0682 seeting NA to zero with sd 0.00181 \footnote{Code  \url{source('~/RProjects/centrality/R/transitivity/calculate_local_transitivity_and_simulate_mean.R')} }

\section{Average path length}
The average path length calculated using the \texttt{mean\_distance} function in igraph is 2.98


This is similar to the L of 2.65 and C of 0.28 of C elegans. The random rewiring with a uniform probability leads to a L of 3.11. \todo{add table of path length}
\todo{add omnigenic bit}%see code source('~/RProjects/graph_transitivity/R/transitivity.R')

If we simulate mean distance using a degree sequence model we get no distance $<$ empirical distance of 2.979 in 1000 simulations.
    
\begin{figure}
    \centering
    \begin{subfigure}[t]{0.45\textwidth}
        \centering
        \includegraphics[width=\linewidth]{images/Rplot_transitivity.png} 
        \caption{Histogram of transitivity} \label{fig:transitivity}
    \end{subfigure}
    \hfill
    \begin{subfigure}[t]{0.45\textwidth}
        \centering
        \includegraphics[width=\linewidth]{images/Rplot01_logdegree_log_transitivity.png} 
        \caption{Plot of degree with mean local transitivity. Log10-log10 scale. Omitting degree $k=1$ as transitivity $C$ will be undefined.} \label{fig:log_transitivity_degree}
    \end{subfigure}
    \caption{Plots of transitivity \textcolor{red}{may want to do this in subfigure packages rather than subcaption to line up edges}}
\end{figure}



%\begin{figure}]h]
%  \includegraphics[width=\linewidth]{Rplot_transitivity}
%  \caption{Transitivity}
%  \label{fig:transitivity}
%\end{figure}
 
%\begin{figure}]h]
%  \includegraphics[width=\linewidth]{Rplot_transitivity_degree}
%  \caption{Local clustering coefficient and degree}
%  \label{fig:transitivity_degree}
%\end{figure}


%\begin{figure}
%    \centering
%    \includegraphics[width=\linewidth]{images/Rplot01_logdegree_log_transitivity.png}
%    \caption{Plot of degree with mean local transitivity. Log10-log10 scale. Omitting degree $k=1$ as transitivity $C$ will be undefined.}
 %   \label{fig:log_transitivity_degree}
%\end{figure}

\subsection{Shortest paths}
\subsection{Betweenness}

Betweenness centrality measures the number of shortest (geodesic) paths through a node. Following Newman if $n_{st}^i$ is one if a shortest path between nodes $s$ and $t$ pass through node $i$ then the betweenness centrality of node $i$ is \begin{equation}
    x_i = \sum_{st} n_{st}^i
\end{equation}
\label{eq: Betweenness centrality}

from Newman \cite{newman2018networks} p172. 

The log transform of betweenness centrality is more nearly normal. The histogram is slightly right skewed.
Although the qq plot looks relatively straight the Shapiro Wilk test for normality after removing infinite values and NA of the log transform  is 
W = 0.997 p = $1.1 \times 10^{-5}$

Top 142 betweeness
Panther 2016

Parkinson’s disease p 2.48 x 10-22
Dopamine mediated signalling pathway

Mammalian phenotype – lethality
BP – regulation of mRNA stability 
MF kinase binding and ubiquitin
CC cell adhesion
	]


Other notes 

enrichment of genes found in the synapse with orthologs in yeast reveal a large number for exosome and mitochondrial elements

\subsection{Bridging}

\cite{valente2010bridging}

\section{Centrality measures and graph statistics}

The correlation between the graph vertex centrality measures eigenvector centrality, betweenness centrality and transitivity are shown in table \ref{Table:Correlation of GWAS gene level statistics with graph vertex measures}

The correlation between the graph vertex centrality measure statistics and the -log \textsubscript{10} transform of the vertex study p value is shown in table \ref{Table:Correlation of GWAS gene level statistics -log10 transform with graph vertex measures}

The Spearman rank correlation for -log\textsubscript{10} is shown in table \ref{Table:Correlation of GWAS gene level statistics Spearmans rho -log10 transform with graph vertex measures} and the rank correlation for p value and vertex statistic is found in table \ref{Table:Correlation of GWAS gene level statistics Spearmans rho gene p  with graph vertex measures} \todo{change S to scientific notation}

The vertex statistics are not normally distributed \todo{test this} and so we prefer the Spearman's rho. the -log\textsubscript{10} has the same value as $-\rho$ for p (signs switch).

\todo{Add multiple testing correction}

\subsection{kcoreness}

A kcore of a graph is an induced subgraph of the main graph such that each vertex has degree of at least $k$. For a vertex its kcoreness is the maximal k core subgraph it is a member of (alternatively its shell index is $c$ if it belongs to the $c$ core but not the $c+1$ core. \cite{seidman1983network} (original description), \cite{alvarez2006large}. The kcore algorithm is useful in graph analysis as it runs in linear time. 

 The minimum shell index is 1, all of the 1 kcore corresponds to the connected component. The range of shell index is 1-24. The median shell index of a vertex is 8 and the mean value 9.15 (although shell indexes take on integer values). The distribution of these values is shown in figure~\ref{fig:Kcore_histogram}\todo{nice ish image of kcore already in core periphery section}
 
 \begin{figure}
     \centering
     \includegraphics[width=\textwidth]{images/Rplot01_kcore_hist.png}
     \caption{Histogram of shell index of vertices in calculation of kcore. Shell index is the maximum kcore a vertex is a member of and not a member of shell index n+1. }
     \label{fig:Kcore_histogram}
 \end{figure}
 
I also calculate the correlation between p and the coreness value of the vertex which is its k core \todo{expand}. There was no significant correlation as shown in table \ref{Table:Correlation of GWAS gene level statistics Spearmans rho gene p  with kcorecoreness measures}

%Code to complete this table is found at STRONTIUM\url{source('~/RProjects/paper_xls_output/R/make_df_graph_stats_correlation_PhDlatex.R')}.
\todo{fixed now}
% latex table generated in R 3.6.2 by xtable 1.8-4 package
% Sat Jan 11 12:31:46 2020
\begin{table}[ht]
\centering
\begin{adjustbox}{max width=\textwidth}
\begin{tabular}{rllrlrrrrl}
  \hline
 & Study & Graph statistic & t & df & p & cor & CI lower & CI upper & Test \\ 
  \hline
1 & Intelligence Discovery & Degree & 0.75 & 3299 & 0.45 & 0.01 & -0.02 & 0.05 & Pearson's product-moment correlation \\ 
  2 & Intelligence Discovery & Betweenness & 0.12 & 3299 & 0.90 & 0.00 & -0.03 & 0.04 & Pearson's product-moment correlation \\ 
  3 & Intelligence Discovery & Eigenvector & 0.73 & 3299 & 0.47 & 0.01 & -0.02 & 0.05 & Pearson's product-moment correlation \\ 
  4 & Intelligence Discovery & Transitivity & -0.94 & 3012 & 0.35 & -0.02 & -0.05 & 0.02 & Pearson's product-moment correlation \\ 
  5 & Intelligence Replication & Degree & -0.64 & 3307 & 0.52 & -0.01 & -0.04 & 0.02 & Pearson's product-moment correlation \\ 
  6 & Intelligence Replication & Betweenness & -0.38 & 3307 & 0.71 & -0.01 & -0.04 & 0.03 & Pearson's product-moment correlation \\ 
  7 & Intelligence Replication & Eigenvector & -0.33 & 3307 & 0.74 & -0.01 & -0.04 & 0.03 & Pearson's product-moment correlation \\ 
  8 & Intelligence Replication & Transitivity & 1.00 & 3019 & 0.31 & 0.02 & -0.02 & 0.05 & Pearson's product-moment correlation \\ 
  9 & Education Discovery & Degree & -0.25 & 3299 & 0.80 & -0.00 & -0.04 & 0.03 & Pearson's product-moment correlation \\ 
  10 & Education Discovery & Betweenness & -1.10 & 3299 & 0.29 & -0.02 & -0.05 & 0.02 & Pearson's product-moment correlation \\ 
  11 & Education Discovery & Eigenvector & 1.00 & 3299 & 0.32 & 0.02 & -0.02 & 0.05 & Pearson's product-moment correlation \\ 
  12 & Education Discovery & Transitivity & 0.09 & 3012 & 0.93 & 0.00 & -0.03 & 0.04 & Pearson's product-moment correlation \\ 
  13 & Education Replication & Degree & -1.20 & 3283 & 0.23 & -0.02 & -0.06 & 0.01 & Pearson's product-moment correlation \\ 
  14 & Education Replication & Betweenness & -0.63 & 3283 & 0.53 & -0.01 & -0.04 & 0.02 & Pearson's product-moment correlation \\ 
  15 & Education Replication & Eigenvector & -0.45 & 3283 & 0.65 & -0.01 & -0.04 & 0.03 & Pearson's product-moment correlation \\ 
  16 & Education Replication & Transitivity & 1.50 & 2998 & 0.14 & 0.03 & -0.01 & 0.06 & Pearson's product-moment correlation \\ 
   \hline
\end{tabular}
\end{adjustbox}
\caption{Correlation of GWAS gene level statistics with graph vertex measures.Code to complete this table is found at STRONTIUM\url{source('~/RProjects/paper_xls_output/R/make_df_graph_stats_correlation_PhDlatex.R')}}
\label{Table:Correlation of GWAS gene level statistics with graph vertex measures}
\end{table}

% latex table generated in R 3.6.2 by xtable 1.8-4 package
% Sat Jan 11 12:43:57 2020
\begin{table}[ht]
\centering
  \begin{adjustbox}{max width=\textwidth}
\begin{tabular}{rllrlrrrrl}
  \hline

 & Study & Graph statistic & t & df & p & cor & confidence\_int\_lower & condidence\_upper & Test \\ 
  \hline
1 & Intelligence Discovery & Degree & -0.40 & 3299 & 0.69 & -0.01 & -0.04 & 0.03 & Pearson's product-moment correlation \\ 
  2 & Intelligence Discovery & Betweenness & 0.04 & 3299 & 0.97 & 0.00 & -0.03 & 0.04 & Pearson's product-moment correlation \\ 
  3 & Intelligence Discovery & Eigenvector & -0.31 & 3299 & 0.76 & -0.01 & -0.04 & 0.03 & Pearson's product-moment correlation \\ 
  4 & Intelligence Discovery & Transitivity & 0.59 & 3012 & 0.56 & 0.01 & -0.03 & 0.05 & Pearson's product-moment correlation \\ 
  5 & Intelligence Replication & Degree & -0.14 & 3307 & 0.89 & -0.00 & -0.04 & 0.03 & Pearson's product-moment correlation \\ 
  6 & Intelligence Replication & Betweenness & -0.41 & 3307 & 0.68 & -0.01 & -0.04 & 0.03 & Pearson's product-moment correlation \\ 
  7 & Intelligence Replication & Eigenvector & -0.51 & 3307 & 0.61 & -0.01 & -0.04 & 0.03 & Pearson's product-moment correlation \\ 
  8 & Intelligence Replication & Transitivity & -0.88 & 3019 & 0.38 & -0.02 & -0.05 & 0.02 & Pearson's product-moment correlation \\ 
  9 & Education Discovery & Degree & -0.84 & 3299 & 0.40 & -0.01 & -0.05 & 0.02 & Pearson's product-moment correlation \\ 
  10 & Education Discovery & Betweenness & -0.55 & 3299 & 0.58 & -0.01 & -0.04 & 0.03 & Pearson's product-moment correlation \\ 
  11 & Education Discovery & Eigenvector & -1.70 & 3299 & 0.08 & -0.03 & -0.06 & 0.00 & Pearson's product-moment correlation \\ 
  12 & Education Discovery & Transitivity & 0.74 & 3012 & 0.46 & 0.01 & -0.02 & 0.05 & Pearson's product-moment correlation \\ 
  13 & Education Replication & Degree & 1.10 & 3283 & 0.29 & 0.02 & -0.02 & 0.05 & Pearson's product-moment correlation \\ 
  14 & Education Replication & Betweenness & 0.87 & 3283 & 0.38 & 0.01 & -0.02 & 0.05 & Pearson's product-moment correlation \\ 
  15 & Education Replication & Eigenvector & -0.05 & 3283 & 0.96 & -0.00 & -0.04 & 0.03 & Pearson's product-moment correlation \\ 
  16 & Education Replication & Transitivity & -2.00 & 2998 & 0.04 & -0.04 & -0.07 & -0.00 & Pearson's product-moment correlation \\ 
   \hline
\end{tabular}
\end{adjustbox}
\caption{Correlation of GWAS gene level statistics -log10 transform with graph vertex measures} 
\label{Table:Correlation of GWAS gene level statistics -log10 transform with graph vertex measures}
\end{table}


% latex table generated in R 3.6.2 by xtable 1.8-4 package
% Sat Jan 11 12:58:15 2020
\begin{table}[ht]
\centering
  \begin{adjustbox}{max width=\textwidth}
\begin{tabular}{rllrrrl}
  \hline
 & Study & Graph statistic & S & p & rho & Test \\ 
  \hline
1 & Intelligence Discovery & Degree & 6200000000.00 & 0.04 & -0.04 & Spearman's rank correlation rho \\ 
  2 & Intelligence Discovery & Betweenness & 6200000000.00 & 0.05 & -0.03 & Spearman's rank correlation rho \\ 
  3 & Intelligence Discovery & Eigenvector & 6200000000.00 & 0.11 & -0.03 & Spearman's rank correlation rho \\ 
  4 & Intelligence Discovery & Transitivity & 4500000000.00 & 0.85 & 0.00 & Spearman's rank correlation rho \\ 
  5 & Intelligence Replication & Degree & 5900000000.00 & 0.20 & 0.02 & Spearman's rank correlation rho \\ 
  6 & Intelligence Replication & Betweenness & 5900000000.00 & 0.21 & 0.02 & Spearman's rank correlation rho \\ 
  7 & Intelligence Replication & Eigenvector & 6000000000.00 & 0.93 & -0.00 & Spearman's rank correlation rho \\ 
  8 & Intelligence Replication & Transitivity & 4700000000.00 & 0.34 & -0.02 & Spearman's rank correlation rho \\ 
  9 & Education Discovery & Degree & 6000000000.00 & 0.69 & -0.01 & Spearman's rank correlation rho \\ 
  10 & Education Discovery & Betweenness & 6000000000.00 & 0.92 & -0.00 & Spearman's rank correlation rho \\ 
  11 & Education Discovery & Eigenvector & 6200000000.00 & 0.07 & -0.03 & Spearman's rank correlation rho \\ 
  12 & Education Discovery & Transitivity & 4600000000.00 & 0.77 & -0.01 & Spearman's rank correlation rho \\ 
  13 & Education Replication & Degree & 5800000000.00 & 0.53 & 0.01 & Spearman's rank correlation rho \\ 
  14 & Education Replication & Betweenness & 5800000000.00 & 0.39 & 0.01 & Spearman's rank correlation rho \\ 
  15 & Education Replication & Eigenvector & 6000000000.00 & 0.65 & -0.01 & Spearman's rank correlation rho \\ 
  16 & Education Replication & Transitivity & 4600000000.00 & 0.10 & -0.03 & Spearman's rank correlation rho \\ 
   \hline
\end{tabular}
\end{adjustbox}
\caption{Correlation of GWAS gene level statistics Spearmans rho -log10 transform with graph vertex measures \url{source('~/RProjects/paper_xls_output/R/make_df_graph_stats_correlation_spearman_log10_PhDlatex.R')}} 
\label{Table:Correlation of GWAS gene level statistics Spearmans rho -log10 transform with graph vertex measures}
\end{table}

% latex table generated in R 3.6.2 by xtable 1.8-4 package
% Sat Jan 11 13:06:00 2020
\begin{table}[ht]
\centering
  \begin{adjustbox}{max width=\textwidth}
\begin{tabular}{rllrrrl}
  \hline
 & Study & Graph statistic & S & p & rho & Test \\ 
  \hline
1 & Intelligence Discovery & Degree & 5800000000.00 & 0.04 & 0.04 & Spearman's rank correlation rho \\ 
  2 & Intelligence Discovery & Betweenness & 5800000000.00 & 0.05 & 0.03 & Spearman's rank correlation rho \\ 
  3 & Intelligence Discovery & Eigenvector & 5800000000.00 & 0.11 & 0.03 & Spearman's rank correlation rho \\ 
  4 & Intelligence Discovery & Transitivity & 4600000000.00 & 0.85 & -0.00 & Spearman's rank correlation rho \\ 
  5 & Intelligence Replication & Degree & 6200000000.00 & 0.20 & -0.02 & Spearman's rank correlation rho \\ 
  6 & Intelligence Replication & Betweenness & 6200000000.00 & 0.21 & -0.02 & Spearman's rank correlation rho \\ 
  7 & Intelligence Replication & Eigenvector & 6000000000.00 & 0.93 & 0.00 & Spearman's rank correlation rho \\ 
  8 & Intelligence Replication & Transitivity & 4500000000.00 & 0.34 & 0.02 & Spearman's rank correlation rho \\ 
  9 & Education Discovery & Degree & 6000000000.00 & 0.69 & 0.01 & Spearman's rank correlation rho \\ 
  10 & Education Discovery & Betweenness & 6000000000.00 & 0.92 & 0.00 & Spearman's rank correlation rho \\ 
  11 & Education Discovery & Eigenvector & 5800000000.00 & 0.07 & 0.03 & Spearman's rank correlation rho \\ 
  12 & Education Discovery & Transitivity & 4500000000.00 & 0.77 & 0.01 & Spearman's rank correlation rho \\ 
  13 & Education Replication & Degree & 6000000000.00 & 0.53 & -0.01 & Spearman's rank correlation rho \\ 
  14 & Education Replication & Betweenness & 6000000000.00 & 0.39 & -0.01 & Spearman's rank correlation rho \\ 
  15 & Education Replication & Eigenvector & 5900000000.00 & 0.65 & 0.01 & Spearman's rank correlation rho \\ 
  16 & Education Replication & Transitivity & 4400000000.00 & 0.10 & 0.03 & Spearman's rank correlation rho \\ 
   \hline
\end{tabular}
  \end{adjustbox}
\caption{Correlation of GWAS gene level statistics Spearmans rho gene p with graph vertex measures \url{source('~/RProjects/paper_xls_output/R/make_df_graph_stats_correlation_spearman_P_PhDlatex.R')}} 
\label{Table:Correlation of GWAS gene level statistics Spearmans rho gene p  with graph vertex measures}
\end{table}

% latex table generated in R 3.6.2 by xtable 1.8-4 package
% Sat Jan 11 13:27:32 2020
\begin{table}[ht]
\centering
  \begin{adjustbox}{max width=\textwidth}
\begin{tabular}{rllrrrl}
  \hline
 & Study & Graph statistic & S & p & rho & Test \\ 
  \hline
5 & Intelligence Discovery & Coreness & 5800000000.00 & 0.07 & 0.03 & Spearman's rank correlation rho \\ 
  10 & Intelligence Replication & Coreness & 6200000000.00 & 0.27 & -0.02 & Spearman's rank correlation rho \\ 
  15 & Education Discovery & Coreness & 5900000000.00 & 0.52 & 0.01 & Spearman's rank correlation rho \\ 
  20 & Education Replication & Coreness & 5900000000.00 & 0.79 & -0.00 & Spearman's rank correlation rho \\ 
   \hline
\end{tabular}
\end{adjustbox}
\caption{Correlation of GWAS gene level statistics Spearmans rho gene p with kcore coreness measures \url{source('~/RProjects/paper_xls_output/R/make_df_graph_stats_correlation_spearman_P_kcore_PhDlatex.R')}} 
\label{Table:Correlation of GWAS gene level statistics Spearmans rho gene p  with kcorecoreness measures}
\end{table}




\subsection{Articulation points}
11 of 68 glutamate receptor binding are articulation points however Gene ontology enrichment analysis ofarticulation points with the entire PSP as background yileds no significant over-representation of terms. They appear to be under represented in ID (3 genes of 203.	 	

\subsection{Centrality and murine models of long term potentiation}

    The centrality measures of genes marked as murine models of LTP were considered as model animal models of intelligence. \footnote{\url{source('~/RProjects/centrality/R/model_ltp/model ltp.R')}}.
    256 genes were identified as a
    ssociated with murine LTD from \textcolor{red}{add Mouse ontology}\todo{add mouse ontology}. 141 of these genes were found in the PSP network model (55.1\%).
    
    There was no statistically significant difference in association between the centrality measures of those genes associated with LTP and the rest of the PSP. Tested degree (0.809), eigenvector centrality (0.630), betweenness (0.895) and transitivity (0.898) Wilcoxon rank sum test with continuity correction. 
    
    A logistic regression model of these factors and LTP PSP as outcome showed that eigenvector centrality and degree were significant factors (4.04 $\times 10^{-6}$ and $1.39 \times 10^{-6}$. The effects were very minor however with McFadden's pseudo R2 \cite{mcfadden1973conditional} calculated using the pscl package was  0.031 \cite{jackman2017package}.


\section{Summary}

We show that in the PSP nodes of very high centrality are associated with essentialness. The PSP has a high degree of essentialness compared to the rest of the genome. 

High degree nodes are associated with specific phenotypes and specific gene ontology terms however the are not correlated with genetic differences that are enriched for differences in intelligence. This is not obvious before the fact and is different from other traits eg essentialness. One might hypothesis that the reason is that there is either no effect (ie it is irrelevant) or that in population studies genes with high centrality are more likely to be essential and hence have less genetic variation. We find also in one of the principle animal models of learning murine long term potentiation that genes of high importance were no more likely or less likely to be involved in long term potentiation.

We use data from the Exac project to further investigate whether high importance nodes were subject to selection pressure such that they proved more intolerant of non synonymous genetic changes. Nodes with high degree are associated with an increased probability of being intolerant to changes. 


 



